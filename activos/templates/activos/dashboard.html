{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - SEMAT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{% static 'activos/css/styless.css' %}">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo-section d-flex align-items-center">
                <div class="logo"></div>
                <span class="brand-name">SEMAT</span>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Navegación</div>
            
                
                <div class="nav-item has-submenu" id="departamentos-menu">
                    <i class="bi bi-building"></i>
                    <span>Departamentos</span>
                </div>
                <div class="submenu" id="departamentos-submenu">
                    <!-- Los departamentos se cargarán aquí -->
                </div>
                
                <div class="nav-item has-submenu" id="reportes-menu">
                    <i class="bi bi-graph-up"></i>
                    <span>Reportes</span>
                </div>
                <div class="submenu" id="reportes-submenu">
                    <!-- Los reportes se cargarán aquí -->
                </div>

                <a href="/activos/" class="nav-item">
                    <i class="bi bi-clipboard-data"></i>
                    <span>Activos</span>
                </a>

            </div>
            
            <div class="nav-section">
                <div class="nav-title">Configuración</div>
                
                <a href="{% url 'logout' %}" class="nav-item">
                    <i class="bi bi-box-arrow-right"></i>
                    <span>Cerrar Sesión</span>
                </a>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h1 class="page-title">Dashboard de Activos</h1>
                <div class="user-menu">
                    <span>Administrador</span>
                    <div class="user-avatar">A</div>
                </div>
            </div>
            
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-title">Total de Activos</div>
                    <div class="stat-value">{{ total_activos }}</div>
                    <div class="stat-change">Sistema de Gestión</div>
                </div>
                
                <div class="stat-card operativo">
                    <div class="stat-title">Activos Operativos</div>
                    <div class="stat-value">{{ activos_operativos }}</div>
                </div>
                
                <div class="stat-card baja">
                    <div class="stat-title">Activos Dañados</div>
                    <div class="stat-value">{{activos_danados}}</div>
                                </div>
            </div>
            
            <!-- Chart Section -->
            <div class="chart-container">
                <div class="chart-title">Distribución por Departamento</div>
                <div class="chart-placeholder">
                    Gráfico de activos por departamento
                </div>
            </div>

        
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Toggle submenu de departamentos
        document.getElementById('departamentos-menu').addEventListener('click', function() {
            this.classList.toggle('open');
            document.getElementById('departamentos-submenu').classList.toggle('open');
        });

        // Toggle submenu de reportes
        document.getElementById('reportes-menu').addEventListener('click', function() {
            this.classList.toggle('open');
            document.getElementById('reportes-submenu').classList.toggle('open');
        });

        // Datos de departamentos
        const departamentos = [
            { nombre: "Administración", url: "{% url 'detalle_departamento' 'Administración' %}", icon: "bi-folder2-open" },
            { nombre: "Fiscalización", url: "{% url 'detalle_departamento' 'Fiscalización' %}", icon: "bi-shield-check" },
            { nombre: "Recaudación", url: "{% url 'detalle_departamento' 'Recaudacion' %}", icon: "bi-cash-coin" },
            { nombre: "Inmuebles", url: "{% url 'detalle_departamento' 'Inmuebles' %}", icon: "bi-house-door" },
            { nombre: "Gerencia Licores", url: "{% url 'detalle_departamento' 'Gerencia Licores' %}", icon: "bi-cup-straw" },
            { nombre: "Gerencia General", url: "{% url 'detalle_departamento' 'Gerencia General' %}", icon: "bi-building" },
            { nombre: "Jurídica", url: "{% url 'detalle_departamento' 'Juridica' %}", icon: "bi-bank" },
            { nombre: "Informática", url: "{% url 'detalle_departamento' 'Informatica' %}", icon: "bi-pc-display" }
        ];

        // Datos de reportes
        const reportes = [
            { nombre: "Reporte GeneralExcel", url: "{% url 'exportar_activos' %}" , icon: "bi-file-bar-graph" },
            { nombre: "Reporte General PDF", url: "{% url 'exportar_pdf_activos'%}" , icon: "bi-file-bar-graph" },
        ];

        // Generar submenu de departamentos
        const submenuDepartamentos = document.getElementById('departamentos-submenu');
        departamentos.forEach(depto => {
            const item = document.createElement('a');
            item.href = depto.url;
            item.className = 'submenu-item';
            item.innerHTML = `
                <i class="bi ${depto.icon}"></i>
                <span>${depto.nombre}</span>
            `;
            submenuDepartamentos.appendChild(item);
        });

        // Generar submenu de reportes
        const submenuReportes = document.getElementById('reportes-submenu');
        reportes.forEach(reporte => {
            const item = document.createElement('a');
            item.href = reporte.url;
            item.className = 'submenu-item';
            item.innerHTML = `
                <i class="bi ${reporte.icon}"></i>
                <span>${reporte.nombre}</span>
            `;
            submenuReportes.appendChild(item);
        });

        // Cerrar submenus al hacer clic fuera
        document.addEventListener('click', function(event) {
            const menus = [
                { menu: 'departamentos-menu', sub: 'departamentos-submenu' },
                { menu: 'reportes-menu', sub: 'reportes-submenu' }
            ];

            menus.forEach(({ menu, sub }) => {
                const menuElement = document.getElementById(menu);
                const subElement = document.getElementById(sub);
                
                if (!menuElement.contains(event.target) && !subElement.contains(event.target)) {
                    menuElement.classList.remove('open');
                    subElement.classList.remove('open');
                }
            });
        });
    </script>
</body>
</html>